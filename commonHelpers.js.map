{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["\nimport axios from \"axios\";\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\niziToast.settings({\n  timeout: 2000,\n  position: 'topRight',\n  transitionIn: \"fadeInRight\",\n    transitionOut: \"fadeOutLeft\",\n    maxWidth: 350,\n});\n\nvar lightbox = new SimpleLightbox(\".photo-card a\", {\n});\n\nconst elements = {\n    searchForm: document.querySelector(\".search-form\"),\n    gallery: document.querySelector(\".gallery\"),\n    btnLoadMore: document.querySelector(\".load-more\"),\n}\n\nlet cardHeight;\nconst perPage = 40;\nlet page = 1;\nlet tag;\n\nelements.searchForm.addEventListener(\"submit\", handlerSearchPhoto);\nelements.btnLoadMore.addEventListener(\"click\", handlerLoadMore);\n\nasync function handlerSearchPhoto(evt) {\n    evt.preventDefault();\n    tag = elements.searchForm[0].value.trim().toLowerCase();\n    elements.btnLoadMore.classList.add(\"hidden\");\n    if (tag) {\n        page = 1;\n\n        elements.searchForm.reset();\n\n        try {\n            const data = await servicePhoto(tag, page, perPage)\n            if (!data.hits.length) {\n                    iziToast.error({\n                        message: \"Sorry, there are no images matching your search query. Please try again.\",\n                    });\n                    elements.gallery.innerHTML = \"<div></div>\";\n                    return;\n                }\n\n                iziToast.success({\n                    message: `Hooray! We found ${data.totalHits} images.`,\n                    });\n                elements.gallery.innerHTML = createMarkupGallary(data.hits);\n                lightbox.refresh();\n        } catch {\n            (err) => console.log(err)\n        }\n    }\n    else {\n         iziToast.warning({\n                        message: \"Fill in the search field!\",\n         });\n        elements.gallery.innerHTML = \"<div></div>\";\n    }\n}\n\nasync function handlerLoadMore() {\n    page += 1;\n\n    try {\n        const data = await servicePhoto(tag, page, perPage);\n        elements.gallery.insertAdjacentHTML(\"beforeend\", createMarkupGallary(data.hits));\n            lightbox.refresh();\n                cardHeight = elements.gallery.firstElementChild.getBoundingClientRect();\n                scrollBy({\n                    top: cardHeight.height * 3,\n                    behavior: \"smooth\",\n                });\n            \n            if (page >= data.totalHits / perPage) {\n                elements.btnLoadMore.classList.add(\"hidden\");\n                // iziToast.error({\n                //         message: \"We're sorry, but you've reached the end of search results.\",\n                //     });\n        }\n    } catch {\n        (err)=>console.log(err)\n    }\n}\n\n\nfunction createMarkupGallary(arr) {\n    return arr.map(({webformatURL, largeImageURL, tags, likes, views, comments, downloads}) => `\n    <div class=\"photo-card\">\n        <a class=\"gallery-link\" href=\"${largeImageURL}\">\n            <div class=\"thumb\">\n                <img src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" width=\"360\" />\n            </div>\n                <div class=\"info\">\n                    <p class=\"info-item\">\n                        <b>Likes</b> ${likes}\n                    </p>\n                    <p class=\"info-item\">\n                        <b>Views</b> ${views}\n                    </p>\n                    <p class=\"info-item\">\n                        <b>Comments</b> ${comments}\n                    </p>\n                    <p class=\"info-item\">\n                        <b>Downloads</b> ${downloads}\n                    </p>\n            </div>\n        </a>\n    </div>\n    `).join(\"\");\n}\n\nasync function servicePhoto(q, page = 1, per_page) {\n    const options = {\n        params: {\n            key:\"40906325-3c4aeac244a0485d830cf7c70\",\n            q,\n            image_type: \"photo\",\n            orientation: \"horizontal\",\n            safesearch: true,\n            per_page: 40,\n            page,\n        }\n    }\n    \n    const { data } = await axios.get(\"https://pixabay.com/api/\", options);\n    \n    if (page <= data.totalHits / per_page) {\n        elements.btnLoadMore.classList.remove(\"hidden\");\n    } else if(data.totalHits) {\n        iziToast.error({\n                        message: \"We're sorry, but you've reached the end of search results.\",\n                    });\n    }\n\n    return data;\n}\n\n"],"names":["iziToast","lightbox","SimpleLightbox","elements","cardHeight","perPage","page","tag","handlerSearchPhoto","handlerLoadMore","evt","data","servicePhoto","createMarkupGallary","arr","webformatURL","largeImageURL","tags","likes","views","comments","downloads","q","per_page","options","axios"],"mappings":"owBAOAA,EAAS,SAAS,CAChB,QAAS,IACT,SAAU,WACV,aAAc,cACZ,cAAe,cACf,SAAU,GACd,CAAC,EAED,IAAIC,EAAW,IAAIC,EAAe,gBAAiB,CACnD,CAAC,EAED,MAAMC,EAAW,CACb,WAAY,SAAS,cAAc,cAAc,EACjD,QAAS,SAAS,cAAc,UAAU,EAC1C,YAAa,SAAS,cAAc,YAAY,CACpD,EAEA,IAAIC,EACJ,MAAMC,EAAU,GAChB,IAAIC,EAAO,EACPC,EAEJJ,EAAS,WAAW,iBAAiB,SAAUK,CAAkB,EACjEL,EAAS,YAAY,iBAAiB,QAASM,CAAe,EAE9D,eAAeD,EAAmBE,EAAK,CAInC,GAHAA,EAAI,eAAc,EAClBH,EAAMJ,EAAS,WAAW,GAAG,MAAM,KAAI,EAAG,cAC1CA,EAAS,YAAY,UAAU,IAAI,QAAQ,EACvCI,EAAK,CACLD,EAAO,EAEPH,EAAS,WAAW,QAEpB,GAAI,CACA,MAAMQ,EAAO,MAAMC,EAAaL,EAAKD,EAAMD,CAAO,EAClD,GAAI,CAACM,EAAK,KAAK,OAAQ,CACfX,EAAS,MAAM,CACX,QAAS,0EACjC,CAAqB,EACDG,EAAS,QAAQ,UAAY,cAC7B,MACH,CAEDH,EAAS,QAAQ,CACb,QAAS,oBAAoBW,EAAK,mBACtD,CAAqB,EACLR,EAAS,QAAQ,UAAYU,EAAoBF,EAAK,IAAI,EAC1DV,EAAS,QAAO,CAChC,MAAU,CAED,CACJ,MAEID,EAAS,QAAQ,CACF,QAAS,2BACjC,CAAU,EACFG,EAAS,QAAQ,UAAY,aAErC,CAEA,eAAeM,GAAkB,CAC7BH,GAAQ,EAER,GAAI,CACA,MAAMK,EAAO,MAAMC,EAAaL,EAAKD,EAAMD,CAAO,EAClDF,EAAS,QAAQ,mBAAmB,YAAaU,EAAoBF,EAAK,IAAI,CAAC,EAC3EV,EAAS,QAAO,EACZG,EAAaD,EAAS,QAAQ,kBAAkB,sBAAqB,EACrE,SAAS,CACL,IAAKC,EAAW,OAAS,EACzB,SAAU,QAC9B,CAAiB,EAEDE,GAAQK,EAAK,UAAYN,GACzBF,EAAS,YAAY,UAAU,IAAI,QAAQ,CAK3D,MAAM,CAED,CACL,CAGA,SAASU,EAAoBC,EAAK,CAC9B,OAAOA,EAAI,IAAI,CAAC,CAAC,aAAAC,EAAc,cAAAC,EAAe,KAAAC,EAAM,MAAAC,EAAO,MAAAC,EAAO,SAAAC,EAAU,UAAAC,CAAS,IAAM;AAAA;AAAA,wCAEvDL;AAAA;AAAA,4BAEZD,WAAsBE;AAAA;AAAA;AAAA;AAAA,uCAIXC;AAAA;AAAA;AAAA,uCAGAC;AAAA;AAAA;AAAA,0CAGGC;AAAA;AAAA;AAAA,2CAGCC;AAAA;AAAA;AAAA;AAAA;AAAA,KAKtC,EAAE,KAAK,EAAE,CACd,CAEA,eAAeT,EAAaU,EAAGhB,EAAO,EAAGiB,EAAU,CAC/C,MAAMC,EAAU,CACZ,OAAQ,CACJ,IAAI,qCACJ,EAAAF,EACA,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,SAAU,GACV,KAAAhB,CACH,CACJ,EAEK,CAAE,KAAAK,CAAI,EAAK,MAAMc,EAAM,IAAI,2BAA4BD,CAAO,EAEpE,OAAIlB,GAAQK,EAAK,UAAYY,EACzBpB,EAAS,YAAY,UAAU,OAAO,QAAQ,EACxCQ,EAAK,WACXX,EAAS,MAAM,CACC,QAAS,4DACjC,CAAqB,EAGVW,CACX"}